name: Test Schema 1
version: 1
versions:
  - version: 1
    url: none
prefix: Test1
namespace: io.apicurio.datamodels.models.test.v1

typeAliases:
  - name: Schema
    type: ArraySchema|ObjectSchema
    unionRules:
      - unionType: ArraySchema
        ruleType: IsJsonObjectWithPropertyValue
        propertyName: type
        propertyJsonType: string
        propertyJsonValue: array
      - unionType: ObjectSchema
        ruleType: IsJsonObjectWithPropertyValue
        propertyName: type
        propertyJsonType: string
        propertyJsonValue: object

# TODO: Complex root type + unions
#root:
#  type: Schema

traits:

  - name: MetadataTrait
    #transparent: true
    properties:
      - name: $comment
        type: string

entities:

#  - name: Foo
#    traits:
#      - MetadataTrait
#    properties: []
#    propertyOrder:
#      - $this


  # TODO: Union type aliases
  - name: ArraySchema
    traits:
      - MetadataTrait
    properties:
      - name: items
        type: ArraySchema|ObjectSchema
        unionRules:
          - unionType: ArraySchema
            ruleType: IsJsonObjectWithPropertyValue
            propertyName: type
            propertyJsonType: string
            propertyJsonValue: array
          - unionType: ObjectSchema
            ruleType: IsJsonObjectWithPropertyValue
            propertyName: type
            propertyJsonType: string
            propertyJsonValue: object
      - name: type
        type: string # TODO type="array"
    propertyOrder:
      - $MetadataTrait
      - $this

  - name: DocumentTODO
    root: true # TODO: Support union roots
    properties:
      - name: __root
        type: ArraySchema|ObjectSchema|boolean
        unionRules:
          - unionType: ArraySchema
            ruleType: IsJsonObjectWithPropertyValue
            propertyName: type
            propertyJsonType: string
            propertyJsonValue: array
          - unionType: ObjectSchema
            ruleType: IsJsonObjectWithPropertyValue
            propertyName: type
            propertyJsonType: string
            propertyJsonValue: object
    propertyOrder:
      - $this

  - name: ObjectSchema
    traits:
      - MetadataTrait
    properties:
      - name: properties
        #type: "{Schema}"
        type: ArraySchema|ObjectSchema
        unionRules:
          - unionType: ArraySchema
            ruleType: IsJsonObjectWithPropertyValue
            propertyName: type
            propertyJsonType: string
            propertyJsonValue: array
          - unionType: ObjectSchema
            ruleType: IsJsonObjectWithPropertyValue
            propertyName: type
            propertyJsonType: string
            propertyJsonValue: object
      - name: type
        type: string # TODO type="object"
    propertyOrder:
      - $MetadataTrait
      - $this
